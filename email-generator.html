<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game of the Week - Email Generator</title>

    <!-- External Dependencies -->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/email-generator.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-envelope"></i> Weekly Email Generator</h1>
            <p class="subtitle">Generate witty, clever, and slightly absurd weekly recap emails</p>
            <a href="index.html" class="back-link"><i class="fas fa-arrow-left"></i> Back to Dashboard</a>
        </header>

        <main>
            <!-- API Key Section -->
            <section class="card api-key-section">
                <h2><i class="fas fa-key"></i> Gemini API Configuration</h2>
                <div class="api-key-input-group">
                    <input
                        type="password"
                        id="apiKey"
                        placeholder="Enter your Gemini API key"
                        class="api-key-input"
                    >
                    <button id="saveApiKey" class="btn btn-primary">
                        <i class="fas fa-save"></i> Save Key
                    </button>
                    <button id="clearApiKey" class="btn btn-secondary">
                        <i class="fas fa-trash"></i> Clear
                    </button>
                </div>
                <p class="help-text">
                    <i class="fas fa-info-circle"></i>
                    Get your free API key at <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a>
                    (stored locally in your browser)
                </p>
            </section>

            <!-- Data Preview Section -->
            <section class="card data-preview-section">
                <h2><i class="fas fa-database"></i> Current Data Summary</h2>
                <div id="dataPreview" class="data-preview">
                    <div class="loading">Loading game data...</div>
                </div>
            </section>

            <!-- Prompt Customization -->
            <section class="card prompt-section">
                <h2><i class="fas fa-wand-magic-sparkles"></i> Email Prompt</h2>
                <textarea
                    id="promptTemplate"
                    class="prompt-textarea"
                    rows="8"
                ></textarea>
                <p class="help-text">
                    <i class="fas fa-lightbulb"></i>
                    Customize the tone and style of your email. The data summary will be automatically included.
                </p>
            </section>

            <!-- Generate Button -->
            <section class="action-section">
                <button id="generateEmail" class="btn btn-generate">
                    <i class="fas fa-robot"></i> Generate Email
                </button>
            </section>

            <!-- Generated Email Preview -->
            <section class="card preview-section" id="previewSection" style="display: none;">
                <div class="preview-header">
                    <h2><i class="fas fa-eye"></i> Generated Email</h2>
                    <div class="preview-actions">
                        <button id="regenerateEmail" class="btn btn-secondary">
                            <i class="fas fa-rotate"></i> Regenerate
                        </button>
                        <button id="copyEmail" class="btn btn-primary">
                            <i class="fas fa-copy"></i> Copy HTML
                        </button>
                    </div>
                </div>
                <div id="emailPreview" class="email-preview"></div>
            </section>

            <!-- Status Messages -->
            <div id="statusMessage" class="status-message"></div>

            <!-- Loading Overlay -->
            <div id="loadingOverlay" class="loading-overlay" style="display: none;">
                <div class="loading-spinner">
                    <div class="spinner"></div>
                    <div class="loading-text">Generating your witty email...</div>
                    <div class="loading-subtext">The AI is crafting something special</div>
                </div>
            </div>
        </main>
    </div>

    <script type="module" src="js/email-generator.js"></script>
</body>
</html>
